BootStrap: docker
From: tensorflow/tensorflow:2.14.0-gpu

%post
    # Update package list and install any additional packages if needed
    apt-get update && apt-get install -y \
        vim \
        git \
        wget \
        htop
    apt update
    apt install -y cmake
    pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
    pip3 install "git+https://github.com/facebookresearch/pytorch3d.git@stable"

    # Clean up
    apt-get clean && rm -rf /var/lib/apt/lists/*

%environment
    export LC_ALL=C
    export LANG=C
    export PATH=/usr/local/bin:$PATH

%runscript
    echo "Machine Learning Container"
    echo "Author: Shah Rukh Qasim <shah.rukh.qasim@cern.ch>."
    echo "TensorFlow 2.14 [CUDA 11.8], PyTorch [CUDA 11.8]"
    exec /bin/bash

%labels
    Author Shah Rukh Qasim
    Version 1.8
    Description This Singularity container can be used to run ML applications based in TensorFlow or PyTorch

